name: Sync master from Manjaro GitLab

on:
  workflow_dispatch:
  schedule:
    - cron: '0 5 * * *'

jobs:
  sync:
    runs-on: ubuntu-latest

    steps:
      # 1️⃣ Checkout a repo PAT-tal
      - name: Checkout GitHub repo
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
          token: ${{ secrets.GH_PAT }}

      # 2️⃣ GitLab remote hozzáadása
      - name: Add GitLab remote
        run: |
          git remote add gitlab https://gitlab.manjaro.org/profiles-and-settings/iso-profiles.git
          git fetch gitlab

      # 3️⃣ Reset master a GitLab masterre
      - name: Reset master to GitLab master
        run: |
          git checkout master
          git reset --hard gitlab/master

      # 4️⃣ Push back to GitHub
      - name: Push to GitHub using PAT
        run: |
          git push origin master --force
