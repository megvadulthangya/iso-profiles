#!/bin/bash
# --- TIMESHIFT BEÃLLÃTÃS SNAPPER HELYETT ---
# Pontosan az eredeti garuda logika szerint

# 1. Root jogosultsÃ¡g ellenÅ‘rzÃ©se
if [[ $EUID -ne 0 ]]; then
   echo "Hiba: Ezt a szkriptet root-kÃ©nt kell futtatni (sudo hasznÃ¡latÃ¡val)"
   exit 1
fi

# 2. Timeshift konfigurÃ¡ciÃ³k helyes elÃ©rÃ©si Ãºton
echo "Timeshift konfigurÃ¡ciÃ³k beÃ¡llÃ­tÃ¡sa ..."

# Timeshift konfigurÃ¡ciÃ³s kÃ¶nyvtÃ¡r lÃ©trehozÃ¡sa
mkdir -p /etc/timeshift

# Helyes Timeshift konfigurÃ¡ciÃ³ - NINCS idÅ‘vonalas mentÃ©s, csak NUMBER snapshotok
cat > /etc/timeshift/timeshift.json << 'EOF'
{
  "backup_device_uuid" : "auto",
  "parent_device_uuid" : "",
  "do_first_run" : "false",
  "btrfs_mode" : "true",
  "include_btrfs_home_for_backup" : "true",
  "include_btrfs_home_for_restore" : "false",
  "stop_cron_emails" : "true",
  "schedule_monthly" : "false",
  "schedule_weekly" : "false",
  "schedule_daily" : "false",
  "schedule_hourly" : "false",
  "schedule_boot" : "false",
  "count_monthly" : "0",
  "count_weekly" : "0",
  "count_daily" : "0",
  "count_hourly" : "0",
  "count_boot" : "0",
  "snapshot_size" : "0",
  "snapshot_count" : "0",
  "date_format" : "%Y-%m-%d %H:%M:%S",
  "exclude" : [
    "/root/***",
    "/opt/***",
    "/var/***",
    "/srv/***",
    "/tmp/***",
    "/var/log/***",
    "/var/tmp/***",
    "/var/cache/***",
    "/.snapshots/***",
    "/timeshift-btrfs/***"
  ],
  "exclude-apps" : []
}
EOF

echo "âœ“ Timeshift konfigurÃ¡ciÃ³ lÃ©trehozva: /etc/timeshift/timeshift.json"

# 3. Timeshift-autosnap konfigurÃ¡ciÃ³ - 10 snapshot limit (mint NUMBER_LIMIT="10")
cat > /etc/timeshift-autosnap.conf << 'EOF'
#
# /etc/timeshift-autosnap.conf
#

# skipAutosnap defines if timeshift-autosnap execution should be skipped.
# Default value is false.
skipAutosnap=false

# skipRsyncAutosnap defines if timeshift-autosnap execution should be skipped on filesystems other than btrfs.
# Default value is true.
skipRsyncAutosnap=true

# deleteSnapshots defines if old snapshots should be deleted.
# Default value is true.
deleteSnapshots=true

# maxSnapshots defines how much old snapshots script should left.
# Only positive whole numbers can be used.
# Default value is 3.
maxSnapshots=10

# updateGrub defines if grub entries should be auto-generated.
# If grub-btrfs package is not installed grub won't be generated.
# Default value is true.
updateGrub=true

# snapshotDescription defines value used to distinguish snapshots created using timeshift-autosnap
# Default value is "{timeshift-autosnap} {created before upgrade}".
snapshotDescription={timeshift-autosnap} {created before upgrade}
EOF

echo "âœ“ Timeshift-autosnap konfigurÃ¡ciÃ³ lÃ©trehozva: /etc/timeshift-autosnap.conf"

# 4. BTRFS maintenance konfigurÃ¡ciÃ³
echo "BTRFS karbantartÃ¡s konfigurÃ¡ciÃ³jÃ¡nak lÃ©trehozÃ¡sa..."

cat > /etc/default/btrfsmaintenance << 'EOF'
# BTRFS karbantartÃ¡si beÃ¡llÃ­tÃ¡sok
BTRFS_LOG_OUTPUT="stdout"

# Defrag beÃ¡llÃ­tÃ¡sok
BTRFS_DEFRAG_PATHS="auto"
BTRFS_DEFRAG_PERIOD="weekly"
BTRFS_DEFRAG_MIN_SIZE="+1M"

# Balance beÃ¡llÃ­tÃ¡sok
BTRFS_BALANCE_MOUNTPOINTS="auto"
BTRFS_BALANCE_PERIOD="monthly"
BTRFS_BALANCE_DUSAGE="5 10"
BTRFS_BALANCE_MUSAGE="5"

# Scrub beÃ¡llÃ­tÃ¡sok
BTRFS_SCRUB_MOUNTPOINTS="auto"
BTRFS_SCRUB_PERIOD="weekly"
BTRFS_SCRUB_PRIORITY="idle"
BTRFS_SCRUB_READ_ONLY="false"

# Trim beÃ¡llÃ­tÃ¡sok
BTRFS_TRIM_PERIOD="weekly"
BTRFS_TRIM_MOUNTPOINTS="auto"

# EgyÃ©b beÃ¡llÃ­tÃ¡sok
BTRFS_ALLOW_CONCURRENCY="false"
EOF

echo "âœ“ BTRFS karbantartÃ¡s konfigurÃ¡lva: /etc/default/btrfsmaintenance"

# 5. VÃ©gsÅ‘ ellenÅ‘rzÃ©s
echo "VÃ©gsÅ‘ ellenÅ‘rzÃ©s..."
echo "LÃ©trehozott konfigurÃ¡ciÃ³s fÃ¡jlok:"
ls -la /etc/timeshift/timeshift.json /etc/timeshift-autosnap.conf /etc/default/btrfsmaintenance 2>/dev/null

echo
echo "âœ… KÃ‰SZ! KonfigurÃ¡ciÃ³k beÃ¡llÃ­tva:"
echo "   - NINCS idÅ‘vonalas mentÃ©s (mint TIMELINE_CREATE=no)"
echo "   - 10 snapshot limit (mint NUMBER_LIMIT=10)"
echo "   - Csak timeshift-autosnap kÃ©szÃ­t snapshotokat (pacman hook)"
echo "   - Home kÃ¶nyvtÃ¡r benne van a mentÃ©sekben"


# ================================================================
#                EGYESÃTETT TELEPÃTÅ Ã‰S KONFIGURÃLÃ“ SCRIPT
# ================================================================
# Ez a script root jogosultsÃ¡gokkal fut, de a felhasznÃ¡lÃ³-specifikus
# mÅ±veleteket (pl. AUR telepÃ­tÃ©s) az eredeti felhasznÃ¡lÃ³ nevÃ©ben vÃ©gzi.
# ================================================================

# --- LogolÃ¡s beÃ¡llÃ­tÃ¡sa ---
# A script minden kimenete a kÃ©pernyÅ‘re Ã‰S egy dÃ¡tumozott log fÃ¡jlba kerÃ¼l.
INSTALL_LOG="install_$(date +%Y%m%d_%H%M%S).log"
exec > >(tee -a "$INSTALL_LOG") 2>&1

# HibakezelÃ©s beÃ¡llÃ­tÃ¡sa: A script kilÃ©p, ha egy parancs hibÃ¡val tÃ©r vissza.
set -euo pipefail

echo ""
echo "--- A TELEPÃTÃ‰S ELKEZDÅDÃ–TT ---"
echo "Minden mÅ±velet a kÃ¶vetkezÅ‘ fÃ¡jlba lesz naplÃ³zva: $INSTALL_LOG"
echo ""


if [ "$(id -u)" -ne "0" ]; then
  echo "Ez a script root jogosultsÃ¡gokat igÃ©nyel. Futtassa sudo-val vagy root-kÃ©nt."
  exit 1
fi

# === MIRROROK BEÃLLÃTÃSA ===
if command -v pacman-mirrors &> /dev/null; then
    echo "Leggyorsabb mirrorok beÃ¡llÃ­tÃ¡sa..."
    pacman-mirrors --fasttrack
    echo "âœ… Mirrorok beÃ¡llÃ­tva"
else
    echo "âš ï¸ pacman-mirrors nem talÃ¡lhatÃ³ (nem Manjaro?)"
fi

# FelhasznÃ¡lÃ³ Ã©s home kÃ¶nyvtÃ¡r meghatÃ¡rozÃ¡sa
if [ -n "${SUDO_USER:-}" ]; then
    USERNAME="$SUDO_USER"
else
    USERNAME=$(logname 2>/dev/null || echo "$(whoami)")
fi

USER_HOME=$(getent passwd "$USERNAME" | cut -d: -f6)

if [ -z "$USER_HOME" ]; then
    echo "Hiba: Nem talÃ¡lhatÃ³ a(z) '$USERNAME' felhasznÃ¡lÃ³ home kÃ¶nyvtÃ¡ra."
    exit 1
fi

echo "FelhasznÃ¡lÃ³: $USERNAME"
echo "FelhasznÃ¡lÃ³ home: $USER_HOME"

# 1. PAMAC ELLENÅRZÃ‰SE Ã‰S BEÃLLÃTÃSA (Manjaro specifikus)
if command -v pamac &> /dev/null; then
    echo "Pamac telepÃ­tve. Pamac konfigurÃ¡ciÃ³ ellenÅ‘rzÃ©se..."
    
    CONFIG_FILE="/etc/pamac.conf"
    AUR_SETTING="EnableAUR"

    if grep -q "^${AUR_SETTING}" "$CONFIG_FILE"; then
        echo "âœ… Pamac AUR tÃ¡mogatÃ¡s: MÃ¡r engedÃ©lyezve."
    else
        if grep -q "^#${AUR_SETTING}" "$CONFIG_FILE"; then
            echo "âš ï¸ Pamac AUR tÃ¡mogatÃ¡s: Tiltva. EngedÃ©lyezÃ©s..."
            sed -i "/^#${AUR_SETTING}/s/^#//g" "$CONFIG_FILE"
            echo "âœ… Pamac AUR tÃ¡mogatÃ¡s: Sikeresen engedÃ©lyezve."
        else
            echo "âŒ Hiba: Az '${AUR_SETTING}' beÃ¡llÃ­tÃ¡s formÃ¡tuma nem megfelelÅ‘ a(z) '${CONFIG_FILE}' fÃ¡jlban."
        fi
    fi
    
    pamac update --force-refresh
    echo "Pamac adatbÃ¡zisok frissÃ­tve."
else
    echo "Pamac nem talÃ¡lhatÃ³. EgyÃ©b AUR segÃ­tÅ‘k ellenÅ‘rzÃ©se..."
    
    if command -v yay &> /dev/null; then
        echo "Yay telepÃ­tve. Az AUR alapÃ©rtelmezetten elÃ©rhetÅ‘ a 'yay' paranccsal."
    elif command -v paru &> /dev/null; then
        echo "Paru telepÃ­tve. Az AUR alapÃ©rtelmezetten elÃ©rhetÅ‘ a 'paru' paranccsal."
    else
        echo "Nincs telepÃ­tett Pamac, Yay vagy Paru. KÃ©zi AUR segÃ©d telepÃ­tÃ©s szÃ¼ksÃ©ges."
    fi
fi

# --- CsomagkezelÅ‘ autodetektÃ¡lÃ¡s ---
if command -v pamac &>/dev/null; then
    PKG_MGR="pamac"
elif command -v paru &>/dev/null; then
    PKG_MGR="paru"
elif command -v yay &>/dev/null; then
    PKG_MGR="yay"
elif command -v pacman &>/dev/null; then
    PKG_MGR="pacman"
else
    echo "Nem talÃ¡lhatÃ³ tÃ¡mogatott csomagkezelÅ‘ (pacman/pamac/yay/paru)."
    exit 1
fi

echo "HasznÃ¡lt csomagkezelÅ‘: $PKG_MGR"

# --- FÃ¼ggvÃ©nyek ---
install_repo() {
    pacman -S --needed --noconfirm "$@"
}

install_aur() {
    case "$PKG_MGR" in
        pamac)
            sudo -u "$USERNAME" pamac install --no-confirm "$@"
            ;;
        yay|paru)
            sudo -u "$USERNAME" $PKG_MGR -S --needed --noconfirm "$@"
            ;;
        pacman)
            echo "Figyelem: AUR csomagok telepÃ­tÃ©sÃ©hez nincs AUR helper telepÃ­tve."
            ;;
    esac
}

# --- Repo csomagok ---
REPO_PKGS=(
  dmenu rofi flameshot picom scrot unclutter xorg-xbacklight alsa-utils mpd mpc playerctl xorg-fonts-misc ttf-roboto woff2-font-awesome arandr lxappearance xorg-xev terminus-font xss-lock wavemon network-manager-applet feh qt6ct geany ttf-firacode-nerd fish starship bat eza jq fzf nano-syntax-highlighting noto-fonts-emoji ugrep expac meld tldr openbsd-netcat
)

echo "Repo csomagok telepÃ­tÃ©se..."
install_repo "${REPO_PKGS[@]}"

# --- AUR csomagok ---
AUR_PKGS=(
  raw-thumbnailer grayjay-bin gsconnect lain-git awesome-git awesome-freedesktop-git tilix-git ttf-font-awesome-5 tamzen-font i3lock-fancy-git betterlockscreen nordic-theme nordic-darker-theme nordic-darker-standard-buttons-theme nordic-polar-standard-buttons-theme nordic-standard-buttons-theme nordic-bluish-accent-theme nordic-bluish-accent-standard-buttons-theme geany-nord-theme nordzy-icon-theme nordic-wallpapers-git oh-my-posh-bin fish-done find-the-command p7zip-gui
)

echo "AUR csomagok telepÃ­tÃ©se..."
install_aur "${AUR_PKGS[@]}"

# --- Ikon font telepÃ­tÃ©se ---
echo "Ikon font telepÃ­tÃ©se $USERNAME szÃ¡mÃ¡ra..."
sudo -u "$USERNAME" mkdir -p "$USER_HOME/.local/share/fonts"
sudo -u "$USERNAME" curl -fL -o "$USER_HOME/.local/share/fonts/Icons.bdf" \
  https://raw.githubusercontent.com/lcpz/dots/refs/heads/master/.fonts/Icons.bdf

echo "Removing inappropriate wallpapers from nordic-wallpapers-git ..."
rm -f /usr/share/backgrounds/nordic-wallpapers-git/artix-nord.png \
      /usr/share/backgrounds/nordic-wallpapers-git/debian.png \
      /usr/share/backgrounds/nordic-wallpapers-git/debian-galaxy.png \
      /usr/share/backgrounds/nordic-wallpapers-git/elementaryos.png \
      /usr/share/backgrounds/nordic-wallpapers-git/fedora.png \
      /usr/share/backgrounds/nordic-wallpapers-git/gnu-linux.png \
      /usr/share/backgrounds/nordic-wallpapers-git/ign_endeavour1.png \
      /usr/share/backgrounds/nordic-wallpapers-git/ign_endeavour2.png \
      /usr/share/backgrounds/nordic-wallpapers-git/ign_endeavour3.png \
      /usr/share/backgrounds/nordic-wallpapers-git/ign_endeavour4.png \
      /usr/share/backgrounds/nordic-wallpapers-git/ign-hevlettpackard.png \
      /usr/share/backgrounds/nordic-wallpapers-git/ign_windows_11.png \
      /usr/share/backgrounds/nordic-wallpapers-git/ign_zorin.png \
      /usr/share/backgrounds/nordic-wallpapers-git/Minimal-Nord.png \
      /usr/share/backgrounds/nordic-wallpapers-git/nixos.png \
      /usr/share/backgrounds/nordic-wallpapers-git/nordic-obsession.png \
      /usr/share/backgrounds/nordic-wallpapers-git/nordtheme.png \
      /usr/share/backgrounds/nordic-wallpapers-git/nord_triangles.png \
      /usr/share/backgrounds/nordic-wallpapers-git/openbsd.png \
      /usr/share/backgrounds/nordic-wallpapers-git/opensuse.png \
      /usr/share/backgrounds/nordic-wallpapers-git/rocket.png \
      /usr/share/backgrounds/nordic-wallpapers-git/slackware.png \
      /usr/share/backgrounds/nordic-wallpapers-git/ubuntu-aurora.png \
      /usr/share/backgrounds/nordic-wallpapers-git/ubuntu-frost.png \
      /usr/share/backgrounds/nordic-wallpapers-git/voidlinux.png \
      /usr/share/backgrounds/nordic-wallpapers-git/voidlinux-01.png

echo "TelepÃ­tÃ©s befejezve!"

# ------------------------------------------------------
# Adi1090x Rofi tÃ©mÃ¡k telepÃ­tÃ©se
# ------------------------------------------------------
echo "[INFO] Rofi tÃ©mÃ¡k telepÃ­tÃ©se a megvadulthangya forkjÃ¡bÃ³l..."

if [ -n "$SUDO_USER" ]; then
    USER_HOME=$(getent passwd "$SUDO_USER" | cut -d: -f6)

    runuser -l "$SUDO_USER" -c '
        echo "[INFO] Rofi tÃ©mÃ¡k letÃ¶ltÃ©se a GitHubrÃ³l...";
        cd /tmp;
        rm -rf rofi;
        git clone --depth=1 -b my-awesome-config https://github.com/megvadulthangya/Awesome-rofi.git rofi;
        cd rofi;
        echo "[INFO] BetÅ±tÃ­pusok telepÃ­tÃ©se...";
        FONT_DIR="$HOME/.local/share/fonts";
        mkdir -p "$FONT_DIR";
        cp -rf fonts/* "$FONT_DIR";
        
        echo "[INFO] BetÅ±tÃ­pus gyorsÃ­tÃ³tÃ¡r frissÃ­tÃ©se...";
        fc-cache -f -v;
        
        ROFI_DIR="$HOME/.config/rofi";
        if [[ -d "$ROFI_DIR" ]]; then
            echo "[INFO] MeglÃ©vÅ‘ Rofi konfigurÃ¡ciÃ³ biztonsÃ¡gi mentÃ©se ide: ${ROFI_DIR}.bak";
            mv "$ROFI_DIR" "${ROFI_DIR}.bak";
        fi
        
        echo "[INFO] Rofi tÃ©mÃ¡k telepÃ­tÃ©se...";
        mkdir -p "$ROFI_DIR";
        cp -rf files/* "$ROFI_DIR";
        
        echo "[SUCCESS] Rofi tÃ©mÃ¡k sikeresen telepÃ­tve.";
    '
    
    echo "[INFO] Ideiglenes fÃ¡jlok tÃ¶rlÃ©se..."
    rm -rf /tmp/rofi
    
else
    echo "[HIBA] A scriptet sudo-val kell futtatni, hogy a felhasznÃ¡lÃ³i beÃ¡llÃ­tÃ¡sokat elvÃ©gezhesse!"
    echo "[HIBA] A Rofi tÃ©mÃ¡k telepÃ­tÃ©se kimarad."
fi

echo "[INFO] Rofi tÃ©ma telepÃ­tÃ©se kÃ©sz."

# --- Nano Syntax Highlighting ---
INSTALL_PATH="/usr/share/nano-syntax-highlighting"

echo "=== Nano Syntax Highlighting telepÃ­tÃ©se system-wide ==="
if [ ! -d "$INSTALL_PATH" ]; then
    git clone https://github.com/scopatz/nanorc.git "$INSTALL_PATH"
fi

if [ -f /etc/nanorc ]; then
    cp /etc/nanorc /etc/nanorc.backup.$(date +%F_%H-%M-%S)
fi

if ! grep -q "include $INSTALL_PATH/*.nanorc" /etc/nanorc 2>/dev/null; then
    echo "include $INSTALL_PATH/*.nanorc" >> /etc/nanorc
fi

echo "=== KÃ©sz! System-wide szintaxis kiemelÃ©s beÃ¡llÃ­tva. ==="

# --- Nano mint alapÃ©rtelmezett szerkesztÅ‘ ---
echo "A 'nano' beÃ¡llÃ­tÃ¡sa alapÃ©rtelmezett szÃ¶vegszerkesztÅ‘nek..."
echo "export EDITOR=nano" | tee -a /etc/environment
echo "nano beÃ¡llÃ­tva alapÃ©rtelmezett szerkesztÅ‘nek!"

# --- safe-lock.sh ---
echo "safe-lock.sh lÃ©trehozÃ¡sa..."
cat <<EOF > /usr/local/bin/safe-lock.sh
#!/usr/bin/env bash
# safe-lock.sh - xss-lock Ã¡ltal hÃ­vva

LOCK_CMD="i3lock-fancy"

is_video_playing() {
  players=\$(playerctl -l 2>/dev/null)
  [ -z "\$players" ] && return 1

  for p in \$players; do
    status=\$(playerctl -p "\$p" status 2>/dev/null || echo "")
    [ "\$status" != "Playing" ] && continue

    media_type=\$(playerctl -p "\$p" metadata mpris:media-type 2>/dev/null || echo "")

    if [ "\$media_type" = "Video" ]; then
      return 0
    fi

    case "\$p" in
      mpv|chromium*|brave*|chrome*|grayjay*)
        return 0
        ;;
    esac
  done

  return 1
}

if is_video_playing; then
  exit 0
fi

exec \$LOCK_CMD
EOF

chmod +x /usr/local/bin/safe-lock.sh
echo "Lock script elhelyezve."















# --- Cleanup: TÃ¶rlÃ©s /root-ban ---
echo "TÃ¶rlÃ©s /root-ban lÃ©vÅ‘ AwesomeWM telepÃ­tÃ©si fÃ¡jlok Ã©s mappÃ¡k..."

# TÃ¶rlendÅ‘ elemek listÃ¡ja
root_items=(
  "/root/autostart/awesome-setup.desktop"
  "/root/awesome"
  "/root/darktable" 
  "/root/awesome-install"
  "/root/awesome-setup-wrapper.sh"
  "/root/awesome-setup.sh"
)

for item in "${root_items[@]}"; do
  if [ -e "$item" ]; then
    rm -rf "$item"
    echo "âœ… $item tÃ¶rÃ¶lve"
  else
    echo "â„¹ï¸  $item nem lÃ©tezik, kihagyva"
  fi
done

# --- Mappa tisztÃ­tÃ¡s ---
echo "RÃ©gi AwesomeWM konfigurÃ¡ciÃ³s mappÃ¡k eltÃ¡volÃ­tÃ¡sa..."

# 1. LekÃ©rjÃ¼k az eredeti felhasznÃ¡lÃ³ home kÃ¶nyvtÃ¡rÃ¡t
USER_HOME=$(getent passwd "$SUDO_USER" | cut -d: -f6)

if [ -z "$USER_HOME" ]; then
    echo "Hiba: Nem talÃ¡lhatÃ³ a(z) '$SUDO_USER' felhasznÃ¡lÃ³ home kÃ¶nyvtÃ¡ra."
    exit 1
fi

# TÃ¶rlÃ©s a felhasznÃ¡lÃ³ home kÃ¶nyvtÃ¡rÃ¡bÃ³l
if [ -d "$USER_HOME/.config/awesome/lain" ]; then
    rm -rf "$USER_HOME/.config/awesome/lain"
    echo "âœ… $USER_HOME/.config/awesome/lain mappa tÃ¶rÃ¶lve"
fi

if [ -d "$USER_HOME/.config/awesome/freedesktop" ]; then
    rm -rf "$USER_HOME/.config/awesome/freedesktop"
    echo "âœ… $USER_HOME/.config/awesome/freedesktop mappa tÃ¶rÃ¶lve"
fi

# TÃ¶rlÃ©s az /etc/skel-bÅ‘l
if [ -d "/etc/skel/.config/awesome/lain" ]; then
    rm -rf "/etc/skel/.config/awesome/lain"
    echo "âœ… /etc/skel/.config/awesome/lain mappa tÃ¶rÃ¶lve"
fi

if [ -d "/etc/skel/.config/awesome/freedesktop" ]; then
    rm -rf "/etc/skel/.config/awesome/freedesktop"
    echo "âœ… /etc/skel/.config/awesome/freedesktop mappa tÃ¶rÃ¶lve"
fi

# --- Szimbolikus linkek lÃ©trehozÃ¡sa ---
echo "Szimbolikus linkek lÃ©trehozÃ¡sa a freedesktop Ã©s lain mappÃ¡khoz..."

# FelhasznÃ¡lÃ³ home kÃ¶nyvtÃ¡r
sudo -u "$USERNAME" -H mkdir -p "$USER_HOME/.config/awesome"
if [ ! -L "$USER_HOME/.config/awesome/freedesktop" ]; then
    sudo -u "$USERNAME" -H ln -s /usr/share/lua/5.3/freedesktop "$USER_HOME/.config/awesome/freedesktop"
    echo "âœ… Link lÃ©trehozva: $USER_HOME/.config/awesome/freedesktop -> /usr/share/lua/5.3/freedesktop"
fi

if [ ! -L "$USER_HOME/.config/awesome/lain" ]; then
    sudo -u "$USERNAME" -H ln -s /usr/share/lua/5.3/lain "$USER_HOME/.config/awesome/lain"
    echo "âœ… Link lÃ©trehozva: $USER_HOME/.config/awesome/lain -> /usr/share/lua/5.3/lain"
fi

# /etc/skel
mkdir -p "/etc/skel/.config/awesome"
if [ ! -L "/etc/skel/.config/awesome/freedesktop" ]; then
    ln -s /usr/share/lua/5.3/freedesktop "/etc/skel/.config/awesome/freedesktop"
    echo "âœ… Link lÃ©trehozva: /etc/skel/.config/awesome/freedesktop -> /usr/share/lua/5.3/freedesktop"
fi

if [ ! -L "/etc/skel/.config/awesome/lain" ]; then
    ln -s /usr/share/lua/5.3/lain "/etc/skel/.config/awesome/lain"
    echo "âœ… Link lÃ©trehozva: /etc/skel/.config/awesome/lain -> /usr/share/lua/5.3/lain"
fi

# --- AwesomeWM Copycats ---
echo "AwesomeWM Copycats konfigurÃ¡ciÃ³ telepÃ­tÃ©se $USERNAME szÃ¡mÃ¡ra..."
cd /tmp
sudo -u "$USERNAME" -H git clone --branch Autoinstall --recurse-submodules --remote-submodules --depth 1 -j 2 \
  https://github.com/megvadulthangya/awesome-copycats-manjaro.git

if [ -d /tmp/awesome-copycats-manjaro ]; then

 # --- Nordic-cursors tÃ©ma telepÃ­tÃ©se ---
  CURSOR_ARCHIVE="/tmp/awesome-copycats-manjaro/Nordic-cursors.tar.xz"
  if [ -f "$CURSOR_ARCHIVE" ]; then
    echo "Nordic-cursors tÃ©ma telepÃ­tÃ©se..."
    tar -xJf "$CURSOR_ARCHIVE" -C /usr/share/icons/ && \
    rm "$CURSOR_ARCHIVE" && \
    echo "âœ… Nordic-cursors tÃ©ma sikeresen telepÃ­tve Ã©s az archÃ­vum tÃ¶rÃ¶lve."
  else
    echo "FIGYELMEZTETÃ‰S: A Nordic-cursors.tar.xz nem talÃ¡lhatÃ³, a kurzor telepÃ­tÃ©se kihagyva."
  fi
  
  # --- Fish konfigurÃ¡ciÃ³ telepÃ­tÃ©se ---
  FISH_CONFIG_ARCHIVE="/tmp/awesome-copycats-manjaro/fish.cfg.tar.xz"
  if [ -f "$FISH_CONFIG_ARCHIVE" ]; then
    echo "Fish konfigurÃ¡ciÃ³ telepÃ­tÃ©se..."
    FISH_CONFIG_DIR="$USER_HOME/.config/fish"
    sudo -u "$USERNAME" -H mkdir -p "$FISH_CONFIG_DIR" && \
    sudo -u "$USERNAME" -H tar -xJf "$FISH_CONFIG_ARCHIVE" -C "$FISH_CONFIG_DIR/" && \
    rm "$FISH_CONFIG_ARCHIVE" && \
    echo "âœ… Fish konfigurÃ¡ciÃ³ sikeresen telepÃ­tve Ã©s az archÃ­vum tÃ¶rÃ¶lve."
  else
    echo "FIGYELMEZTETÃ‰S: A fish.cfg.tar.xz nem talÃ¡lhatÃ³, a fish konfigurÃ¡ciÃ³ telepÃ­tÃ©se kihagyva."
  fi
  
  # Csak a szÃ¼ksÃ©ges elemek mÃ¡solÃ¡sa
  sudo -u "$USERNAME" -H mkdir -p "$USER_HOME/.config/awesome"
  
  # Themes mappa mÃ¡solÃ¡sa
  if [ -d "/tmp/awesome-copycats-manjaro/themes" ]; then
    sudo -u "$USERNAME" -H cp -r "/tmp/awesome-copycats-manjaro/themes" "$USER_HOME/.config/awesome/"
    echo "âœ… Themes mappa sikeresen mÃ¡solva."
  fi
  
  # TovÃ¡bbi .xz fÃ¡jlok kezelÃ©se (ha vannak)
  for xz_file in /tmp/awesome-copycats-manjaro/*.xz; do
    if [ -f "$xz_file" ] && [ "$(basename "$xz_file")" != "Nordic-cursors.tar.xz" ] && [ "$(basename "$xz_file")" != "fish.cfg.tar.xz" ]; then
      filename=$(basename "$xz_file")
      echo "TovÃ¡bbi .xz fÃ¡jl talÃ¡lhatÃ³: $filename"
      # Itt adhatunk hozzÃ¡ tovÃ¡bbi kezelÃ©si logikÃ¡t, ha szÃ¼ksÃ©ges
    fi
  done
  
  rm -rf /tmp/awesome-copycats-manjaro
  echo "âœ… Csak a szÃ¼ksÃ©ges elemek mÃ¡solva ide: $USER_HOME/.config/awesome"
else
  echo "HIBA: Nem sikerÃ¼lt klÃ³nozni a repÃ³t!"
fi

echo "âœ… A cleanup Ã©s Ãºj konfigurÃ¡ciÃ³ telepÃ­tÃ©se befejezÅ‘dÃ¶tt."

















echo "=== i3lock-fancy javÃ­tÃ¡sa (convert â†’ magick convert) ==="
if [ -f /usr/bin/i3lock-fancy ]; then
  sed -i 's/\bconvert\b/magick/g' /usr/bin/i3lock-fancy
  echo "i3lock-fancy sikeresen javÃ­tva!"
else
  echo "Figyelem: /usr/bin/i3lock-fancy nem talÃ¡lhatÃ³."
fi

# ----------------------------------------------------------------------
# XFCE NORDIC TÃ‰MA BEÃLLÃTÃ“ SCRIPTE (SUDO-KOMPATIBILIS)
# ----------------------------------------------------------------------

# 1. CÃ©lfelhasznÃ¡lÃ³ azonosÃ­tÃ¡sa
if [ "$EUID" -ne 0 ]; then
  echo "Hiba: A szkriptet root jogosultsÃ¡gokkal (sudo-val) kell futtatni."
  exit 1
fi

TARGET_USER=${SUDO_USER}

if [ -z "$TARGET_USER" ]; then
  TARGET_USER=$(logname 2>/dev/null)
fi

if [ -z "$TARGET_USER" ]; then
  echo "Hiba: Nem sikerÃ¼lt azonosÃ­tani a cÃ©lfelhasznÃ¡lÃ³t (SUDO_USER Ã¼res vagy logname sikertelen)."
  echo "A szkript futtatÃ¡sa megszakÃ­tva."
  exit 1
fi

TARGET_UID=$(id -u ${TARGET_USER})
RUNNER="sudo -u ${TARGET_USER} DBUS_SESSION_BUS_ADDRESS=unix:path=/run/user/${TARGET_UID}/bus"

echo "BeÃ¡llÃ­tÃ¡sok futtatÃ¡sa a kÃ¶vetkezÅ‘ felhasznÃ¡lÃ³ nevÃ©ben: ${TARGET_USER} (UID: ${TARGET_UID})"
echo "---"

# 3. Xfconf beÃ¡llÃ­tÃ¡sok elindÃ­tÃ¡sa
echo "-> GTK TÃ©ma beÃ¡llÃ­tÃ¡sa: Nordic"
${RUNNER} xfconf-query -c xsettings -p /Net/ThemeName -s "Nordic-standard-buttons" --create -t string

echo "-> Ikon TÃ©ma beÃ¡llÃ­tÃ¡sa: Nordzy-dark"
${RUNNER} xfconf-query -c xsettings -p /Net/IconThemeName -s "Nordzy-dark" --create -t string

echo "-> EgÃ©rmutatÃ³ TÃ©ma beÃ¡llÃ­tÃ¡sa: Nordic-cursors"
${RUNNER} xfconf-query -c xsettings -p /Gtk/CursorThemeName -s "Nordic-cursors" --create -t string

echo "-> SzÃ­npaletta beÃ¡llÃ­tÃ¡sa..."
COLOR_PALETTE="black:white:gray50:red:purple:blue:light blue:green:yellow:orange:lavender:brown:goldenrod4:dodger blue:pink:light green:gray10:gray30:gray75:gray90"
${RUNNER} xfconf-query -c xsettings -p /Gtk/ColorPalette -s "${COLOR_PALETTE}" --create -t string

echo "---"
echo "âœ… Az Xfce Nordic tÃ©ma beÃ¡llÃ­tÃ¡sai sikeresen alkalmazva a ${TARGET_USER} felhasznÃ¡lÃ³nak."

# ----------------------------------------------------------------------
# GTK Ã‰S QT BEÃLLÃTÃSOK
# ----------------------------------------------------------------------

# EllenÅ‘rizzÃ¼k, hogy a scriptet root-kÃ©nt (sudo-val) futtatjÃ¡k-e
if [ "$EUID" -ne 0 ]; then
  echo "KÃ©rlek futtasd ezt a scriptet sudo-val: sudo $0"
  exit 1
fi

# A felhasznÃ¡lÃ³, aki a sudo-t hasznÃ¡lta
REGULAR_USER=${SUDO_USER:-root}
REGULAR_USER_HOME=$(eval echo ~$REGULAR_USER)

# --- GTK BEÃLLÃTÃSOK ---
apply_gtk_settings() {
  local TARGET_HOME=$1
  local TARGET_USER=$2

  echo "=> GTK beÃ¡llÃ­tÃ¡sok alkalmazÃ¡sa a(z) '$TARGET_USER' felhasznÃ¡lÃ³ szÃ¡mÃ¡ra a '$TARGET_HOME' mappÃ¡ban..."

  # GTK-2.0 beÃ¡llÃ­tÃ¡sok
  cat <<EOF > "$TARGET_HOME/.gtkrc-2.0"
# DO NOT EDIT! This file will be overwritten by LXAppearance.
# Any customization should be done in ~/.gtkrc-2.0.mine instead.

include "~/.gtkrc-2.0.mine"
gtk-theme-name="Nordic-standard-buttons"
gtk-icon-theme-name="Nordzy-dark"
gtk-font-name="FiraCode Nerd Font 12"
gtk-cursor-theme-name="Nordic-cursors"
gtk-cursor-theme-size=16
gtk-toolbar-style=GTK_TOOLBAR_ICONS
gtk-toolbar-icon-size=GTK_ICON_SIZE_LARGE_TOOLBAR
gtk-button-images=1
gtk-menu-images=1
gtk-sound-theme-name=freedesktop
gtk-enable-event-sounds=1
gtk-enable-input-feedback-sounds=1
gtk-xft-antialias=1
gtk-xft-hinting=1
gtk-xft-hintstyle="hintfull"
gtk-xft-rgba="rgb"
gtk-application-prefer-dark-theme=1
EOF

  # GTK-3.0 beÃ¡llÃ­tÃ¡sok
  mkdir -p "$TARGET_HOME/.config/gtk-3.0"
  cat <<EOF > "$TARGET_HOME/.config/gtk-3.0/settings.ini"
[Settings]
gtk-theme-name=Nordic-standard-buttons
gtk-icon-theme-name=Nordzy-dark
gtk-font-name=FiraCode Nerd Font 12
gtk-cursor-theme-name=Nordic-cursors
gtk-toolbar-style=GTK_TOOLBAR_ICONS
gtk-toolbar-icon-size=GTK_ICON_SIZE_LARGE_TOOLBAR
gtk-button-images=1
gtk-menu-images=1
gtk-enable-event-sounds=1
gtk-enable-input-feedback-sounds=1
gtk-xft-antialias=1
gtk-xft-hinting=1
gtk-xft-hintstyle=hinfull
gtk-sound-theme-name=freedesktop
gtk-application-prefer-dark-theme=1
EOF

  # Tulajdonos beÃ¡llÃ­tÃ¡sa
  chown -R "$TARGET_USER:$TARGET_USER" "$TARGET_HOME/.gtkrc-2.0" "$TARGET_HOME/.config"
  echo "GTK2/GTK3 kÃ©sz!"
  echo
}

# --- QT BEÃLLÃTÃSOK ---
apply_qt_settings() {
  local TARGET_HOME=$1
  local TARGET_USER=$2

  echo "=> Qt5/Qt6 beÃ¡llÃ­tÃ¡sok alkalmazÃ¡sa a(z) '$TARGET_USER' felhasznÃ¡lÃ³ szÃ¡mÃ¡ra a '$TARGET_HOME' mappÃ¡ban..."

  # --- Qt5ct ---
  mkdir -p "$TARGET_HOME/.config/qt5ct"
  cat <<EOF > "$TARGET_HOME/.config/qt5ct/qt5ct.conf"
[Appearance]
color_scheme_path=/usr/share/qt5ct/colors/darker.conf
custom_palette=true
icon_theme=Nordzy-dark
standard_dialogs=default
style=Fusion

[Fonts]
fixed="FiraCode Nerd Font,12,-1,5,50,0,0,0,0,0,Regular"
general="FiraCode Nerd Font,12,-1,5,50,0,0,0,0,0,Regular"

[Interface]
activate_item_on_single_click=1
buttonbox_layout=3
cursor_flash_time=1000
dialog_buttons_have_icons=1
double_click_interval=400
gui_effects=@Invalid()
keyboard_scheme=2
menus_have_icons=true
show_shortcuts_in_context_menus=true
stylesheets=@Invalid()
toolbutton_style=4
underline_shortcut=1
wheel_scroll_lines=3

[SettingsWindow]
geometry=@ByteArray(\x1\xd9\xd0\xcb\0\x3\0\0\0\0\0\0\0\0\0\0\0\0\x4\xff\0\0\x2\xfa\0\0\0\0\0\0\0\x1c\0\0\x4\xff\0\0\x2\xfa\0\0\0\0\x2\0\0\0\x5\0\0\0\0\0\0\0\0 \0\0\x4\xff\0\0\x2\xfa)

[Troubleshooting]
force_raster_widgets=1
ignored_applications=@Invalid()
EOF

  # --- Qt6ct ---
  mkdir -p "$TARGET_HOME/.config/qt6ct"
  cat <<EOF > "$TARGET_HOME/.config/qt6ct/qt6ct.conf"
[Appearance]
custom_palette=false
icon_theme=Nordzy-dark
standard_dialogs=default
style=kvantum

[Fonts]
fixed="FiraCode Nerd Font,12,-1,5,400,0,0,0,0,0,0,0,0,0,0,1,Regular"
general="FiraCode Nerd Font,12,-1,5,400,0,0,0,0,0,0,0,0,0,0,1,Regular"

[Interface]
activate_item_on_single_click=1
buttonbox_layout=0
cursor_flash_time=1200
dialog_buttons_have_icons=1
double_click_interval=532
gui_effects=@Invalid()
keyboard_scheme=2
menus_have_icons=true
show_shortcuts_in_context_menus=true
stylesheets=@Invalid()
toolbutton_style=4
underline_shortcut=1
wheel_scroll_lines=3

[SettingsWindow]
geometry=@ByteArray(\x1\xd9\xd0\xcb\0\x3\0\0\0\0\0\0\0\0\0\0\0\0\x4\xff\0\0\x2\xfa\0\0\0\0\0\0\0 \0\0\x4\xff\0\0\x2\xfa\0\0\0\0\x2\0\0\0\x5\0\0\0\0\0\0\0\0 \0\0\x4\xff\0\0\x2\xfa)

[Troubleshooting]
force_raster_widgets=1
ignored_applications=@Invalid()
EOF

  # Tulajdonos beÃ¡llÃ­tÃ¡sa
  chown -R "$TARGET_USER:$TARGET_USER" "$TARGET_HOME/.config/qt5ct" "$TARGET_HOME/.config/qt6ct"
  echo "Qt5/Qt6 kÃ©sz!"
  echo
}

# --- A SCRIPT FÅ RÃ‰SZE: A FUNKCIÃ“ MEGHÃVÃSA ---

# 1. Alkalmazzuk a beÃ¡llÃ­tÃ¡sokat a SUDO-t futtatÃ³ felhasznÃ¡lÃ³ra
if [ "$REGULAR_USER" != "root" ]; then
    apply_gtk_settings "$REGULAR_USER_HOME" "$REGULAR_USER"
    apply_qt_settings "$REGULAR_USER_HOME" "$REGULAR_USER"
else
    echo "=> A scriptet kÃ¶zvetlenÃ¼l root-kÃ©nt futtatod, a felhasznÃ¡lÃ³i beÃ¡llÃ­tÃ¡sokat Ã¡tugorjuk."
    echo
fi

# 2. Alkalmazzuk a beÃ¡llÃ­tÃ¡sokat a ROOT felhasznÃ¡lÃ³ra
apply_gtk_settings ~ "root"
apply_qt_settings ~ "root"

echo "Minden GTK Ã©s Qt beÃ¡llÃ­tÃ¡s sikeresen alkalmazva."

# ----------------------------------------------------------------------
# KVANTUM TÃ‰MÃK TELEPÃTÃ‰SE RENDSZERSZINTEN
# ----------------------------------------------------------------------

echo "=== Kvantum tÃ©mÃ¡k telepÃ­tÃ©se rendszerszinten ==="

# Kvantum tÃ©mÃ¡k letÃ¶ltÃ©se Ã©s RENDSZERSZINTÅ° telepÃ­tÃ©se
echo "Nordic Kvantum tÃ©mÃ¡k letÃ¶ltÃ©se rendszerszintre..."
cd /tmp
if [ -d "Nordic" ]; then
    rm -rf Nordic
fi

git clone --depth=1 https://github.com/EliverLara/Nordic.git
cd Nordic/kde/kvantum

# RENDSZERSZINTÅ° tÃ©mÃ¡k telepÃ­tÃ©se - /usr/share/Kvantum mappÃ¡ba
KVANTUM_SYSTEM_DIR="/usr/share/Kvantum"
mkdir -p "$KVANTUM_SYSTEM_DIR"

# TÃ©mÃ¡k kicsomagolÃ¡sa RENDSZERSZINTÅ° kÃ¶nyvtÃ¡rba
for theme_file in *.tar.xz; do
    if [ -f "$theme_file" ]; then
        theme_name="${theme_file%.tar.xz}"
        echo "Kvantum tÃ©ma telepÃ­tÃ©se rendszerszintre: $theme_name"
        tar -xf "$theme_file" -C "$KVANTUM_SYSTEM_DIR/"
        # Jogok beÃ¡llÃ­tÃ¡sa, hogy mindenki elÃ©rhesse
        chmod -R 755 "$KVANTUM_SYSTEM_DIR/$theme_name"
    fi
done

# Ha nincsenek tar.xz fÃ¡jlok, akkor a mappÃ¡kat mÃ¡soljuk
if [ ! -f "Nordic.tar.xz" ]; then
    for theme_dir in Nordic*; do
        if [ -d "$theme_dir" ]; then
            echo "Kvantum tÃ©ma mÃ¡solÃ¡sa rendszerszintre: $theme_dir"
            cp -r "$theme_dir" "$KVANTUM_SYSTEM_DIR/"
            chmod -R 755 "$KVANTUM_SYSTEM_DIR/$theme_dir"
        fi
    done
fi

echo "âœ… Kvantum tÃ©mÃ¡k telepÃ­tve rendszerszinten"

# TakarÃ­tÃ¡s
cd /
rm -rf /tmp/Nordic

# ----------------------------------------------------------------------
# LIGHTDM GREETER BEÃLLÃTÃSA
# ----------------------------------------------------------------------

echo "=== LightDM GTK Greeter beÃ¡llÃ­tÃ¡sa ==="

# EllenÅ‘rizzÃ¼k, hogy a kÃ©p fÃ¡jl lÃ©tezik-e
BACKGROUND_FILE="/usr/share/backgrounds/nordic-wallpapers-git/ign_groot.png"
if [ ! -f "$BACKGROUND_FILE" ]; then
    echo "Figyelem: A hÃ¡ttÃ©rkÃ©p nem talÃ¡lhatÃ³: $BACKGROUND_FILE"
    echo "AlternatÃ­v hÃ¡ttÃ©rkÃ©p keresÃ©se..."
    # AlternatÃ­v hÃ¡ttÃ©rkÃ©p keresÃ©se
    ALTERNATIVE_BG=$(find /usr/share/backgrounds/nordic-wallpapers-git -name "*.png" -o -name "*.jpg" | head -1)
    if [ -n "$ALTERNATIVE_BG" ]; then
        BACKGROUND_FILE="$ALTERNATIVE_BG"
        echo "AlternatÃ­v hÃ¡ttÃ©rkÃ©p hasznÃ¡lata: $BACKGROUND_FILE"
    else
        echo "Hiba: Nem talÃ¡lhatÃ³ hÃ¡ttÃ©rkÃ©p a nordic-wallpapers-git mappÃ¡ban!"
    fi
fi

# LightDM config fÃ¡jl biztonsÃ¡gi mentÃ©se
LIGHTDM_CONFIG="/etc/lightdm/lightdm-gtk-greeter.conf"
if [ -f "$LIGHTDM_CONFIG" ]; then
    cp "$LIGHTDM_CONFIG" "${LIGHTDM_CONFIG}.backup.$(date +%Y%m%d%H%M%S)"
    echo "LightDM config biztonsÃ¡gi mentÃ©se kÃ©sz"
fi

# LightDM greeter konfigurÃ¡ciÃ³ alkalmazÃ¡sa
echo "LightDM greeter konfigurÃ¡ciÃ³ beÃ¡llÃ­tÃ¡sa..."
cat > "$LIGHTDM_CONFIG" << EOF
[greeter]
background = $BACKGROUND_FILE
user-background = false
font-name = FiraCode Nerd Font 12
xft-antialias = true
icon-theme-name = Nordzy
screensaver-timeout = 60
theme-name = Nordic
cursor-theme-name = Nordic-cursors
show-clock = true
default-user-image = #manjaro
xft-hintstyle = hintfull
position = 20%,center 40%,center
clock-format = %Y.%m.%d %H:%M
panel-position = bottom
indicators = ~host;~spacer;~clock;~spacer;~language;~session;~a11y;~power
EOF

echo "âœ… LightDM GTK Greeter beÃ¡llÃ­tva"

# ----------------------------------------------------------------------
# FISH SHELL ALAPÃ‰RTELMEZETTÃ‰ TÃ‰TELE
# ----------------------------------------------------------------------

echo "=== Fish shell alapÃ©rtelmezettÃ© tÃ©tele ==="

# A Fish shell teljes elÃ©rÃ©si ÃºtjÃ¡nak megkeresÃ©se
FISH_PATH=$(command -v fish)

# EllenÅ‘rzÃ©s, hogy a Fish telepÃ­tve van-e
if [ -z "$FISH_PATH" ]; then
    echo "Hiba: A Fish shell nincs telepÃ­tve vagy nem talÃ¡lhatÃ³ az elÃ©rÃ©si Ãºtvonalon."
    exit 1
fi

echo "Fish shell alapÃ©rtelmezettÃ© tÃ©tele..."

# HozzÃ¡adjuk a Fish-t az engedÃ©lyezett shellekhez, ha mÃ©g nem szerepel ott
if ! grep -q "^${FISH_PATH}$" /etc/shells; then
    echo "A(z) '$FISH_PATH' hozzÃ¡adÃ¡sa a /etc/shells fÃ¡jlhoz..."
    echo "$FISH_PATH" | tee -a /etc/shells
fi

# AlapÃ©rtelmezett shell beÃ¡llÃ­tÃ¡sa a root felhasznÃ¡lÃ³nak
echo "Shell beÃ¡llÃ­tÃ¡sa a 'root' felhasznÃ¡lÃ³nak..."
chsh -s "$FISH_PATH" root

echo "KÃ©sz! A Fish shell sikeresen beÃ¡llÃ­tva."

# ===========================================================================
# === KONFIGURÃCIÃ“S FÃJLOK BEÃLLÃTÃSA - JELENLEGI FELHASZNÃLÃ“ Ã‰S /etc/skel ===
# ===========================================================================

echo "=== KonfigurÃ¡ciÃ³s fÃ¡jlok beÃ¡llÃ­tÃ¡sa mindenkinek ==="

# --- FÃ¼ggvÃ©ny fÃ¡jlok mÃ¡solÃ¡sÃ¡ra felhasznÃ¡lÃ³hoz Ã©s /etc/skel-be ---
setup_config_file() {
    local source_content="$1"
    local user_path="$2"
    local skel_path="/etc/skel/${user_path#$USER_HOME/}"
    local user_dir=$(dirname "$user_path")
    local skel_dir=$(dirname "$skel_path")
    
    # FelhasznÃ¡lÃ³i fÃ¡jl lÃ©trehozÃ¡sa
    echo "  FelhasznÃ¡lÃ³: $user_path"
    sudo -u "$USERNAME" mkdir -p "$user_dir"
    echo "$source_content" | sudo -u "$USERNAME" tee "$user_path" > /dev/null
    
    # /etc/skel fÃ¡jl lÃ©trehozÃ¡sa
    echo "  /etc/skel: $skel_path"
    mkdir -p "$skel_dir"
    echo "$source_content" | tee "$skel_path" > /dev/null
}

# --- Geany color scheme ---
#echo "Geany color scheme beÃ¡llÃ­tÃ¡sa..."
#setup_config_file '[geany]
#color_scheme=nord.conf' "$USER_HOME/.config/geany/geany.conf"

# --- Zsh beÃ¡llÃ­tÃ¡sok ---
echo "Zsh beÃ¡llÃ­tÃ¡sa..."
setup_config_file '# Use powerline
USE_POWERLINE="true"
# Has weird character width
# Example:
#   î‚²î‚° is not a diamond
HAS_WIDECHARS="false"
# Source manjaro-zsh-configuration
if [[ -e /usr/share/zsh/manjaro-zsh-config ]]; then
  source /usr/share/zsh/manjaro-zsh-config
fi
# Use manjaro zsh prompt
if [[ -e /usr/share/zsh/manjaro-zsh-prompt ]]; then
  source /usr/share/zsh/manjaro-zsh-prompt
fi
if [ $TILIX_ID ] || [ $VTE_VERSION ]; then
        source /etc/profile.d/vte.sh
fi' "$USER_HOME/.zshrc"

# --- Kvantum beÃ¡llÃ­tÃ¡s --- FIXED VERSION ---
echo "Kvantum beÃ¡llÃ­tÃ¡sa..."
KVANTUM_CONFIG='[General]
theme=Nordic'

# FelhasznÃ¡lÃ³i konfigurÃ¡ciÃ³
KVANTUM_USER_DIR="$USER_HOME/.config/Kvantum"
KVANTUM_USER_FILE="$KVANTUM_USER_DIR/kvantum.kvconfig"
sudo -u "$USERNAME" mkdir -p "$KVANTUM_USER_DIR"
echo "$KVANTUM_CONFIG" | sudo -u "$USERNAME" tee "$KVANTUM_USER_FILE" > /dev/null

# /etc/skel konfigurÃ¡ciÃ³
KVANTUM_SKEL_DIR="/etc/skel/.config/Kvantum"
KVANTUM_SKEL_FILE="$KVANTUM_SKEL_DIR/kvantum.kvconfig"
mkdir -p "$KVANTUM_SKEL_DIR"
echo "$KVANTUM_CONFIG" | tee "$KVANTUM_SKEL_FILE" > /dev/null

echo "âœ… Kvantum konfigurÃ¡ciÃ³ beÃ¡llÃ­tva"

# --- .xprofile beÃ¡llÃ­tÃ¡s ---
echo ".xprofile beÃ¡llÃ­tÃ¡sa..."
setup_config_file 'export QT_QPA_PLATFORMTHEME="qt6ct"
# Monitor setup
if [ -f "$HOME/.screenlayout/layout.sh" ]; then
    # Mivel ez az X session indÃ­tÃ¡sakor fut, a DISPLAY mÃ¡r elÃ©rhetÅ‘
    bash "$HOME/.screenlayout/layout.sh" &
fi
' "$USER_HOME/.xprofile"

# --- .profile beÃ¡llÃ­tÃ¡s ---
echo ".profile beÃ¡llÃ­tÃ¡sa..."
setup_config_file 'export EDITOR=/usr/bin/nano
export QT_QPA_PLATFORMTHEME="qt6ct"
export QT_AUTO_SCREEN_SCALE_FACTOR=0
export GTK2_RC_FILES="$HOME/.gtkrc-2.0"' "$USER_HOME/.profile"

# === Bashrc beÃ¡llÃ­tÃ¡sok (biztonsÃ¡gos, hozzÃ¡fÅ±zÅ‘ mÃ³dszer) ===
echo "Bashrc beÃ¡llÃ­tÃ¡sa (hozzÃ¡fÅ±zÃ©ssel)..."

# DefiniÃ¡ljuk a kÃ³drÃ©szletet, amit hozzÃ¡ akarunk adni
VTE_SNIPPET=$(cat <<'EOF'

# Automatikusan hozzÃ¡adva a Tilix/VTE integrÃ¡ciÃ³hoz
if [ $TILIX_ID ] || [ $VTE_VERSION ]; then
    source /etc/profile.d/vte.sh
fi
EOF
)

# --- 1. FelhasznÃ¡lÃ³i .bashrc mÃ³dosÃ­tÃ¡sa ---
BASHRC_USER_PATH="$USER_HOME/.bashrc"
echo "  EllenÅ‘rzÃ©s: $BASHRC_USER_PATH"

# EllenÅ‘rizzÃ¼k, hogy a bejegyzÃ©s mÃ¡r lÃ©tezik-e, hogy elkerÃ¼ljÃ¼k a duplikÃ¡ciÃ³t
if ! grep -q "source /etc/profile.d/vte.sh" "$BASHRC_USER_PATH" 2>/dev/null; then
    echo "  VTE bejegyzÃ©s hozzÃ¡adÃ¡sa a felhasznÃ¡lÃ³ .bashrc fÃ¡jljÃ¡hoz..."
    # HozzÃ¡fÅ±zzÃ¼k a kÃ³drÃ©szletet a fÃ¡jl vÃ©gÃ©hez
    echo "$VTE_SNIPPET" | sudo -u "$USERNAME" tee -a "$BASHRC_USER_PATH" > /dev/null
else
    echo "  A VTE bejegyzÃ©s mÃ¡r lÃ©tezik, nincs teendÅ‘."
fi

# --- 2. /etc/skel/.bashrc mÃ³dosÃ­tÃ¡sa ---
BASHRC_SKEL_PATH="/etc/skel/.bashrc"
echo "  EllenÅ‘rzÃ©s: $BASHRC_SKEL_PATH"

# Itt is ellenÅ‘rizzÃ¼k a duplikÃ¡ciÃ³t
if ! grep -q "source /etc/profile.d/vte.sh" "$BASHRC_SKEL_PATH" 2>/dev/null; then
    echo "  VTE bejegyzÃ©s hozzÃ¡adÃ¡sa a /etc/skel/.bashrc fÃ¡jlhoz..."
    # HozzÃ¡fÅ±zzÃ¼k a kÃ³drÃ©szletet a fÃ¡jl vÃ©gÃ©hez (itt mÃ¡r nem kell sudo -u)
    echo "$VTE_SNIPPET" | tee -a "$BASHRC_SKEL_PATH" > /dev/null
else
    echo "  A VTE bejegyzÃ©s mÃ¡r lÃ©tezik, nincs teendÅ‘."
fi

echo "Bashrc beÃ¡llÃ­tÃ¡sa kÃ©sz."

# --- XFCE xsettings beÃ¡llÃ­tÃ¡sok ---
echo "XFCE xsettings beÃ¡llÃ­tÃ¡sa..."
setup_config_file '<?xml version="1.1" encoding="UTF-8"?>

<channel name="xsettings" version="1.0">
  <property name="Net" type="empty">
    <property name="ThemeName" type="string" value="Nordic-standard-buttons"/>
    <property name="IconThemeName" type="string" value="Nordzy-dark"/>
    <property name="DoubleClickTime" type="int" value="532"/>
    <property name="DoubleClickDistance" type="int" value="8"/>
    <property name="DndDragThreshold" type="int" value="8"/>
    <property name="CursorBlink" type="bool" value="true"/>
    <property name="CursorBlinkTime" type="int" value="1200"/>
    <property name="SoundThemeName" type="string" value="default"/>
    <property name="EnableEventSounds" type="bool" value="false"/>
    <property name="EnableInputFeedbackSounds" type="bool" value="false"/>
  </property>
  <property name="Xft" type="empty">
    <property name="DPI" type="int" value="96"/>
    <property name="Antialias" type="int" value="1"/>
    <property name="Hinting" type="int" value="-1"/>
    <property name="HintStyle" type="string" value="hintfull"/>
    <property name="RGBA" type="string" value="none"/>
  </property>
  <property name="Gtk" type="empty">
    <property name="CanChangeAccels" type="bool" value="false"/>
    <property name="ColorPalette" type="string" value="black:white:gray50:red:purple:blue:light blue:green:yellow:orange:lavender:brown:goldenrod4:dodger blue:pink:light green:gray10:gray30:gray75:gray90"/>
    <property name="FontName" type="string" value="FiraCode Nerd Font 12"/>
    <property name="MonospaceFontName" type="empty"/>
    <property name="IconSizes" type="string" value=""/>
    <property name="KeyThemeName" type="string" value=""/>
    <property name="MenuImages" type="bool" value="true"/>
    <property name="ButtonImages" type="bool" value="true"/>
    <property name="MenuBarAccel" type="string" value="F10"/>
    <property name="CursorThemeName" type="string" value="Nordic-cursors"/>
    <property name="CursorThemeSize" type="int" value="0"/>
    <property name="DecorationLayout" type="string" value="icon,menu:minimize,maximize,close"/>
    <property name="DialogsUseHeader" type="empty"/>
    <property name="TitlebarMiddleClick" type="empty"/>
    <property name="ToolbarStyle" type="string" value="icons"/>
    <property name="ToolbarIconSize" type="int" value="3"/>
    <property name="IMPreeditStyle" type="string" value=""/>
    <property name="IMStatusStyle" type="string" value=""/>
    <property name="IMModule" type="string" value=""/>
  </property>
  <property name="Gdk" type="empty">
    <property name="WindowScalingFactor" type="empty"/>
  </property>
  <property name="Xfce" type="empty">
    <property name="LastCustomDPI" type="int" value="96"/>
  </property>
</channel>' "$USER_HOME/.config/xfce4/xfconf/xfce-perchannel-xml/xsettings.xml"

# --- XFCE xfwm4 beÃ¡llÃ­tÃ¡sok ---
echo "XFCE xfwm4 beÃ¡llÃ­tÃ¡sa..."
setup_config_file '<?xml version="1.0" encoding="UTF-8"?>

<channel name="xfwm4" version="1.0">
  <property name="general" type="empty">
    <property name="activate_action" type="string" value="bring"/>
    <property name="borderless_maximize" type="bool" value="true"/>
    <property name="box_move" type="bool" value="false"/>
    <property name="box_resize" type="bool" value="false"/>
    <property name="button_layout" type="string" value="O|SHMC"/>
    <property name="button_offset" type="int" value="0"/>
    <property name="button_spacing" type="int" value="0"/>
    <property name="click_to_focus" type="bool" value="true"/>
    <property name="focus_delay" type="int" value="250"/>
    <property name="cycle_apps_only" type="bool" value="false"/>
    <property name="cycle_draw_frame" type="bool" value="true"/>
    <property name="cycle_hidden" type="bool" value="true"/>
    <property name="cycle_minimum" type="bool" value="true"/>
    <property name="cycle_workspaces" type="bool" value="false"/>
    <property name="double_click_time" type="int" value="250"/>
    <property name="double_click_distance" type="int" value="5"/>
    <property name="double_click_action" type="string" value="maximize"/>
    <property name="easy_click" type="string" value="Alt"/>
    <property name="focus_hint" type="bool" value="true"/>
    <property name="focus_new" type="bool" value="true"/>
    <property name="frame_opacity" type="int" value="100"/>
    <property name="full_width_title" type="bool" value="true"/>
    <property name="inactive_opacity" type="int" value="100"/>
    <property name="maximized_offset" type="int" value="0"/>
    <property name="move_opacity" type="int" value="100"/>
    <property name="placement_ratio" type="int" value="60"/>
    <property name="placement_mode" type="string" value="center"/>
    <property name="popup_opacity" type="int" value="100"/>
    <property name="mousewheel_rollup" type="bool" value="true"/>
    <property name="prevent_focus_stealing" type="bool" value="false"/>
    <property name="raise_delay" type="int" value="250"/>
    <property name="raise_on_click" type="bool" value="true"/>
    <property name="raise_on_focus" type="bool" value="false"/>
    <property name="raise_with_any_button" type="bool" value="true"/>
    <property name="repeat_urgent_blink" type="bool" value="false"/>
    <property name="resize_opacity" type="int" value="100"/>
    <property name="restore_on_move" type="bool" value="true"/>
    <property name="scroll_workspaces" type="bool" value="true"/>
    <property name="shadow_delta_height" type="int" value="0"/>
    <property name="shadow_delta_width" type="int" value="0"/>
    <property name="shadow_delta_x" type="int" value="0"/>
    <property name="shadow_delta_y" type="int" value="-3"/>
    <property name="shadow_opacity" type="int" value="50"/>
    <property name="show_app_icon" type="bool" value="false"/>
    <property name="show_dock_shadow" type="bool" value="true"/>
    <property name="show_frame_shadow" type="bool" value="true"/>
    <property name="show_popup_shadow" type="bool" value="false"/>
    <property name="snap_resist" type="bool" value="false"/>
    <property name="snap_to_border" type="bool" value="true"/>
    <property name="snap_to_windows" type="bool" value="false"/>
    <property name="snap_width" type="int" value="10"/>
    <property name="theme" type="string" value="Nordic-standard-buttons"/>
    <property name="title_alignment" type="string" value="center"/>
    <property name="title_font" type="string" value="FiraCode Nerd Font 12"/>
    <property name="title_horizontal_offset" type="int" value="0"/>
    <property name="title_shadow_active" type="string" value="false"/>
    <property name="title_shadow_inactive" type="string" value="false"/>
    <property name="title_vertical_offset_active" type="int" value="0"/>
    <property name="title_vertical_offset_inactive" type="int" value="0"/>
    <property name="toggle_workspaces" type="bool" value="false"/>
    <property name="unredirect_overlays" type="bool" value="true"/>
    <property name="urgent_blink" type="bool" value="false"/>
    <property name="use_compositing" type="bool" value="true"/>
    <property name="workspace_count" type="int" value="2"/>
    <property name="wrap_cycle" type="bool" value="true"/>
    <property name="wrap_layout" type="bool" value="true"/>
    <property name="wrap_resistance" type="int" value="10"/>
    <property name="wrap_windows" type="bool" value="true"/>
    <property name="wrap_workspaces" type="bool" value="false"/>
    <property name="workspace_names" type="array">
      <value type="string" value="Workspace 1"/>
      <value type="string" value="Workspace 2"/>
      <value type="string" value="Workspace 3"/>
      <value type="string" value="Workspace 4"/>
    </property>
    <property name="tile_on_move" type="bool" value="true"/>
    <property name="titleless_maximize" type="bool" value="false"/>
    <property name="cycle_preview" type="bool" value="true"/>
    <property name="cycle_tabwin_mode" type="int" value="0"/>
    <property name="sync_to_vblank" type="bool" value="true"/>
    <property name="zoom_desktop" type="bool" value="true"/>
  </property>
</channel>' "$USER_HOME/.config/xfce4/xfconf/xfce-perchannel-xml/xfwm4.xml"

# --- Flameshot beÃ¡llÃ­tÃ¡sok ---
echo "Flameshot beÃ¡llÃ­tÃ¡sa..."
setup_config_file '[General]
contrastOpacity=188
drawColor=#ff0000
uiColor=#f5eef8' "$USER_HOME/.config/flameshot/flameshot.ini"

# --- Fontok Ã¡thelyezÃ©se rendszerszintÅ±vÃ© ---
echo "Fontok Ã¡thelyezÃ©se rendszerszintÅ±vÃ©..."
mkdir -p /usr/share/fonts/truetype/custom

# FelhasznÃ¡lÃ³ fontjainak Ã¡thelyezÃ©se
if [ -d "$USER_HOME/.local/share/fonts" ]; then
    echo "FelhasznÃ¡lÃ³ fontjainak Ã¡thelyezÃ©se rendszerszintÅ±vÃ©..."
    mv "$USER_HOME/.local/share/fonts"/* /usr/share/fonts/truetype/custom/ 2>/dev/null || true
    rmdir "$USER_HOME/.local/share/fonts" 2>/dev/null || true
fi

# /etc/skel font mappa Ã¼rÃ­tÃ©se, mert a fontok most mÃ¡r rendszerszintÅ±ek
if [ -d "/etc/skel/.local/share/fonts" ]; then
    echo "/etc/skel font mappa Ã¼rÃ­tÃ©se..."
    rm -rf /etc/skel/.local/share/fonts
fi

fc-cache -fv
echo "âœ… Fontok Ã¡thelyezve rendszerszintÅ±vÃ©: /usr/share/fonts/truetype/custom/"

# --- AwesomeWM Ã©s Rofi mÃ¡solÃ¡sa /etc/skel-be ---
echo "AwesomeWM Ã©s Rofi konfigurÃ¡ciÃ³ mÃ¡solÃ¡sa /etc/skel-be..."
if [ -d "$USER_HOME/.config/awesome" ]; then
    mkdir -p /etc/skel/.config
    cp -r "$USER_HOME/.config/awesome" /etc/skel/.config/
    # SablonosÃ­tjuk a rc.lua-t
    if [ -f "/etc/skel/.config/awesome/rc.lua" ]; then
        sed -i "s|${USER_HOME}|__USER_HOME__|g" "/etc/skel/.config/awesome/rc.lua"
    fi
fi

if [ -d "$USER_HOME/.config/rofi" ]; then
    mkdir -p /etc/skel/.config
    cp -r "$USER_HOME/.config/rofi" /etc/skel/.config/
fi

if [ -d "$USER_HOME/.config/fish" ]; then
    mkdir -p /etc/skel/.config
    cp -r "$USER_HOME/.config/fish" /etc/skel/.config/
fi


echo "==> EngedÃ©lyezem a udisks2 szolgÃ¡ltatÃ¡st..."
systemctl enable udisks2.service

echo "==> IndÃ­tom a udisks2 szolgÃ¡ltatÃ¡st..."
systemctl start udisks2.service

echo "==> EllenÅ‘rzÃ©s..."
STATUS=$(systemctl is-enabled udisks2.service)
if [ "$STATUS" = "enabled" ]; then
    echo "âœ… udisks2 automatikus indÃ­tÃ¡sa engedÃ©lyezve"
else
    echo "âš ï¸  Nem sikerÃ¼lt engedÃ©lyezni a szolgÃ¡ltatÃ¡st!"
fi

systemctl status udisks2.service --no-pager


# --- MPD felhasznÃ¡lÃ³i szolgÃ¡ltatÃ¡s indÃ­tÃ¡sa ---
echo "MPD felhasznÃ¡lÃ³i szolgÃ¡ltatÃ¡s indÃ­tÃ¡sa..."
if [ -n "$SUDO_USER" ]; then
    USER_HOME=$(getent passwd "$SUDO_USER" | cut -d: -f6)
    sudo -u "$SUDO_USER" DBUS_SESSION_BUS_ADDRESS=unix:path=/run/user/$(id -u "$SUDO_USER")/bus systemctl --user enable --now mpd
    echo "âœ… MPD felhasznÃ¡lÃ³i szolgÃ¡ltatÃ¡s indÃ­tva"
else
    echo "âš ï¸  MPD szolgÃ¡ltatÃ¡s indÃ­tÃ¡sa kihagyva (nincs SUDO_USER)"
fi


echo "=== ğŸ’£ Mission Impossibru - Dual-Stage Edition w/ Logging ==="

USERNAME=$(logname)
USER_HOME=$(eval echo "~$USERNAME")
SOURCE_DIR="$USER_HOME/.config/rofi/scripts"
TARGET_DIR="$USER_HOME/.local/bin"
SKEL_DIR="/etc/skel"
MAIN_SCRIPT_NAME="mission_impossibru.sh"
USER_SCRIPT_NAME="mission_user_firstlogin.sh"

echo "ğŸ‘¤ AktuÃ¡lis felhasznÃ¡lÃ³: $USERNAME"
echo "ğŸ  Home: $USER_HOME"

# === ROFI/SCRIPTS MAPPÃNAK TÃ–RLÃ‰SE (rootkÃ©nt) ===
if [ -d "$SOURCE_DIR" ]; then
    rm -rf "$SOURCE_DIR"
    echo "âœ… $SOURCE_DIR mappa Ã©s tartalma tÃ¶rÃ¶lve"
else
    echo "â„¹ A $SOURCE_DIR mappa nem lÃ©tezik, nincs mit tÃ¶rÃ¶lni"
fi


echo ""
echo "ğŸ‰ Mission Impossibru - CLEAN SKEL EDITION beÃ¡llÃ­tva!"
echo "   âœ… LogolÃ¡s bekapcsolva: ~/.mission_impossibru.log"



#============================================================================
# === VÃ‰GE - MINDEN FELHASZNÃLÃ“ SZÃMÃRA ===
# ===========================================================================

echo ""
echo "ğŸ‰ MINDEN KÃ‰SZ! ğŸ‰"
echo ""
echo "âœ… Ã–sszes rendszerszintÅ± telepÃ­tÃ©s befejezve"
echo "âœ… A jelenlegi felhasznÃ¡lÃ³ megkapta a beÃ¡llÃ­tÃ¡sokat"
echo "âœ… Az /etc/skel beÃ¡llÃ­tva - Ãºj felhasznÃ¡lÃ³k automatikusan megkapjÃ¡k a konfigurÃ¡ciÃ³t"
echo "âœ… Nordic tÃ©ma beÃ¡llÃ­tva mindenhol (GTK, QT, Kvantum, AwesomeWM, LightDM, XFCE)"
echo "âœ… Fish shell beÃ¡llÃ­tva alapÃ©rtelmezettkÃ©nt (csak root)"
echo "âœ… Fontok Ã¡thelyezve rendszerszintÅ±vÃ©: /usr/share/fonts/truetype/custom/"
echo "âœ… Rofi szkriptek szimbolikus linkjei lÃ©trehozva"
echo "âœ… Emoji font telepÃ­tve (noto-fonts-emoji)"
echo ""
echo "â„¹ï¸  Fontos:"
echo "   - Minden Ãºj felhasznÃ¡lÃ³ automatikusan megkapja a Nordic tÃ©mÃ¡t"
echo "   - A jelenlegi felhasznÃ¡lÃ³ is megkapta az Ã¶sszes beÃ¡llÃ­tÃ¡st"
echo "   - A fontok most mÃ¡r rendszerszintÅ±ek (/usr/share/fonts/truetype/custom/)"
echo "   - Az emojik most mÃ¡r megjelennek a terminÃ¡lban"
echo ""
echo "ÃšjraindÃ­thatod a rendszert a teljes Ã©lmÃ©nyÃ©rt:"
echo ""
echo ""
echo ""
echo "ğŸ“‹ A teljes naplÃ³ itt talÃ¡lhatÃ³: $INSTALL_LOG"
echo
echo
echo "âš ï¸  A RENDSZER TAKARÃTÃSÃHOZ Ã‰S Ã–NMEGSEMMISÃTÃ‰SHEZ"
echo "   NYOMJ ENTER-T A FOLYTATÃSHOZ..."
echo
read -p ">>> "

# === Ã–NMEGSEMMISÃTÅ SZKEKVENCIA ===
clear
echo
echo 
echo
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘                              â•‘"
echo "â•‘       MISSION IMPOSSIBRU     â•‘"
echo "â•‘                              â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "â•‘                              â•‘"
echo "â•‘Ã–NMEGSEMMISÃTÅ RENDSZER AKTÃV â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo

echo "ğŸš¨ FIGYELMEZTETÃ‰S: Ez az Ã¼zenet 5 mÃ¡sodperc mÃºlva Ã¶nmegsemmisÃ¼l!"
sleep 2

echo
echo "ğŸ’¥ RENDSZER TAKARÃTÃS KEZDET"
echo "================================"
sleep 1

# VisszaszÃ¡mlÃ¡lÃ¡s drÃ¡mai effekttel
for i in {5..1}; do
    echo "â° $i..."
    sleep 1
done

echo
echo "ğŸ’£ TAKARÃTÃS FOLYAMATBAN..."
echo "~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"

echo "ğŸ”¹ Launcher script eltÃ¡volÃ­tÃ¡sa..."
rm -f "$USER_HOME/awesome-setup-wrapper.sh"
rm -f "$USER_HOME/awesome-setup.sh"

echo "ğŸ”¹ Autostart fÃ¡jl tÃ¶rlÃ©se..."
rm -f "$USER_HOME/.config/autostart/awesome-setup.desktop"

echo "ğŸ”¹ SKEL mappa takarÃ­tÃ¡sa..."
rm -f "/opt/system_setup/awesome-setup-wrapper.sh"
rm -f "/opt/system_setup/awesome-setup.sh"
#rm -f "/etc/skel/awesome-install"
rm -f "/etc/skel/.config/autostart/awesome-setup.desktop"
rm -rf "/root/.config/awesome"
rm -rf "/root/.config/darktable"
rm -f "/root/.config/autostart/awesome-setup.desktop"

echo
echo "ğŸ’¨ FÃœSTÃ–LGÅ NYOMOK ELTÃVOLÃTASA..."
sleep 2

# ASCII "fÃ¼st" effekt
echo "   .--.   "
echo "  (    )  "
echo " (_)  /   "
echo "   \\ (    "
echo "    ) )   "
echo "   ( (    "
echo "    \\ \\   "
echo "     \\ \\  "
echo "      ) ) "
echo "     / /  "
echo "    ( (   "
echo "     \\ \\  "
echo "      \\ \\ "
echo "       \\_\\"

echo
echo "ğŸ¯ FÅ TELEPÃTÅ SCRIPT Ã–NMEGSEMMISÃTÃ‰SE..."
rm -f "$USER_HOME/awesome_install"

echo
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘          âœ… MISSION COMPLETE           â•‘"
echo "â•‘        ğŸ¬ MINDEN NYOM ELTÅ°NT           â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo
exit 0
